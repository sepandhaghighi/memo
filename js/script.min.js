const version="0.1.3";var color,colorList=[],blockNumber=4,darkColors=["BLACK","DARKSLATEGRAY","SLATEGRAY","DIMGRAY","GRAY","MAROON","BROWN","SIENNA","SADDLEBROWN","CHOCOLATE","PERU","DARKGOLDENROD","GOLDENROD","MIDNIGHTBLUE","NAVY","DARKBLUE","MEDIUMBLUE","BLUE","ROYALBLUE","MEDIUMSLATEBLUE","DODGERBLUE","STEELBLUE","TEAL","DARKCYAN","DARKOLIVEGREEN","OLIVEDRAB","DARKGREEN","GREEN","FORESTGREEN","MEDIUMSEAGREEN","SEAGREEN","LIMEGREEN","LIME","MEDIUMSLATEBLUE","INDIGO","DARKMAGENTA","DARKORCHID","DARKVIOLET","REBECCAPURPLE","BLUEVIOLET","MAGENTA","DARKKHAKI","ORANGE","DARKORANGE","ORANGERED","MEDIUMVIOLETRED","DEEPPINK","DARKRED","FIREBRICK","RED","CRIMSON"],lightColors=["LIGHTSALMON","LIGHTCORAL","PINK","LIGHTPINK","LIGHTSALMON","ORANGE","LIGHTYELLOW","LEMONCHIFFON","PAPAYAWHIP","PEACHPUFF","PALEGOLDENROD","LAVENDER","THISTLE","PALEGREEN","MEDIUMAQUAMARINE","LIGHTCYAN","PALETURQUOISE","LIGHTSTEELBLUE","CORNSILK","WHEAT","SNOW","HONEYDEW","MINTCREAM","AZURE","GHOSTWHITE","BEIGE","FLORALWHITE","LINEN","LAVENDERBLUSH","GAINSBORO","SILVER","LIGHTGRAY"];colorList=darkColors;var textColor="white",selectedItem=[],timeouts=[],currentMove=0,simFlag=!1,playerFlag=!1,mutationFlag1=!1,mutationFlag2=!1,mutationLevel1=7,mutationLevel2=14,gameCounter=0,tickAwsome='<i class="fa fa-check fa-3x" aria-hidden="true" style="color:white"></i>',starAwsome='<i class="fa fa-star fa-3x" aria-hidden="true" style="color:white"></i>',timesAwsome='<i class="fa fa-times fa-3x" aria-hidden="true" style="color:white"></i>',trophyAwsome='<i class="fa fa-trophy fa-3x" aria-hidden="true" style="color:white"></i>',soundOn='<i class="fa fa-volume-up fa-3x" aria-hidden="true" ></i>',soundOff='<i class="fa fa-volume-off fa-3x" aria-hidden="true"></i>',speed=2500,speedStep=400,speedDefault=2500,offset=1e3,nextLevelDelay=1e3,resetDelay=500,gameOverDelay=500,goDelay=700,levelShowDelay=1e3,level=1,selectCounter=1,score=0,bestScore=0,musicTemp=[],hr=new Date().getHours(),startTime=null,endTime=null,gameTime="00:00:00",bestGameTime="00:00:00",musicList=["files/bensound-acousticbreeze.mp3","files/bensound-adaytoremember.mp3","files/bensound-smile.mp3","files/bensound-sunny.mp3","files/bensound-ukulele.mp3"],musicRandom=Math.floor(Math.random()*musicList.length),audio=new Audio(musicList[musicRandom]),playStatus=!1,newRecordNotif="";function audioControl(){!0==playStatus?(audio.pause(),playStatus=!1,document.getElementById("sound_on_off").innerHTML=soundOff):(audio.play(),playStatus=!0,document.getElementById("sound_on_off").innerHTML=soundOn)}function localSave(e,t,o){"undefined"!=typeof Storage&&(localStorage.setItem("mnimi_score",e),localStorage.setItem("mnimi_game",t),localStorage.setItem("mnimi_time",o))}function localLoad(){"undefined"!=typeof Storage&&((gameCounter=parseInt(localStorage.getItem("mnimi_game")))?(bestScore=parseInt(localStorage.getItem("mnimi_score")),null==(bestGameTime=localStorage.getItem("mnimi_time"))&&(bestGameTime="00:00:00"),bestScore==NaN&&(bestScore=0),bestScore>0&&(document.getElementById("score_button").innerHTML="SCORE("+bestScore.toString()+")",document.getElementById("score_button").style.display="inline")):gameCounter=0)}function redirect(e){switch(e){case 1:window.open("https://github.com/sepandhaghighi/mnimi");break;case 2:swal({title:"Bitocin Wallet",text:"1KtNLEEeUbTEK9PdN6Ya3ZAKXaqoKUuxCy",customClass:"swal-bitcoin"});break;case 3:window.open("mailto:info@mnimi.ir");break;case 4:window.open("https://www.coffeete.ir/opensource");break;case 5:window.open("help.html","_self");break;case 6:window.open("donate.html","_self");break;case 7:window.open("index.html","_self");break;default:window.open("")}}function swalHelp(){swal({title:"Hi",text:'<p style="text-align:justify">Mnimi is a game of memory skill inspired by Simon electronic game. The game creates a series of lights and requires a user to repeat the sequence. If the user succeeds, the series becomes progressively longer and more complex. Once the user fails, the game is over.</p>',html:!0,customClass:"swal-wide"})}function begin(){tableStyle(mode=!1),localLoad(),swalHelp(),init()}function init(){color=colorList[Math.floor(Math.random()*colorList.length)].toLowerCase();var e,t,o=[];for(t=1,(e=document.getElementById("game_name")).style.color=color,e.innerHTML="Mnimi Game (v0.1.3)";t<blockNumber+1;)0>o.indexOf(randomColor=colorList[Math.floor(Math.random()*colorList.length)].toLowerCase())&&(o.push(randomColor),document.getElementById(t.toString()).style.backgroundColor=randomColor,t+=1)}function set(e,t=1,o=1){1==t?document.getElementById(e.toString()).innerHTML=o.toString()+starAwsome:2==t?document.getElementById(e.toString()).innerHTML=o.toString()+tickAwsome:document.getElementById(e.toString()).innerHTML=timesAwsome}function reset(e){document.getElementById(e.toString()).innerHTML=""}function selectItems(){for(var e,t=selectCounter-selectedItem.length,o=0;o<t;o++)e=Math.floor(Math.random()*blockNumber)+1,selectedItem.push(e)}function sequence(e){var t;set(t=selectedItem[e],mode=1,seq=e+1),e+1>=selectedItem.length?timeouts.push(window.setTimeout(function(){reset(t),playerGo(),simFlag=!1,tableStyle(mode=!0)},speed)):(timeouts.push(window.setTimeout(function(){reset(t)},speed)),timeouts.push(window.setTimeout(function(){sequence(e+1)},speed+offset)))}function simulation(){clear(),selectItems(),sequence(0)}function mutation(e=!0){var t,o,i,n,l,a;!0==e?(t=document.getElementById("mnimi"),blockNumber+=2,o=t.insertRow(1),!1==mutationFlag2?o.id="mutation-row1":o.id="mutation-row2",(i=o.insertCell(0)).id=(blockNumber-1).toString(),i.onclick=function(){replyClick(i.id)},(n=o.insertCell(1)).id=blockNumber.toString(),n.onclick=function(){replyClick(n.id)}):(blockNumber=4,l=document.getElementById("mutation-row1"),a=document.getElementById("mutation-row2"),null!=l&&l.remove(),null!=a&&a.remove()),init()}function mutationCheck(){level>mutationLevel1&&!1==mutationFlag1&&mutation(mutationFlag1=!0),level>mutationLevel2&&!1==mutationFlag2&&mutation(mutationFlag2=!0)}function scoreUpdate(){var e;(e=document.getElementById("win")).innerHTML=score.toString()}function timeConvert(e,t){var o,i,n,l=t-e,a=Math.floor(l/1e3/60/60),r=Math.floor((l-=36e5*a)/1e3/60),s=Math.floor((l-=6e4*r)/1e3);return o=a.toString(),i=r.toString(),n=s.toString(),1==o.length&&(o="0"+o),1==i.length&&(i="0"+i),1==n.length&&(n="0"+n),o+":"+i+":"+n}function gameOver(){gameTime=timeConvert(startTime,endTime=new Date),gameCounter+=1,score>bestScore?(bestScore=score,bestGameTime=gameTime,newRecordNotif="<h2>New Record!</h2>&nbsp;"):newRecordNotif="",swal({title:"",text:newRecordNotif+'<table align="center" style="font-size:26px;"><tr><td style="padding:20px;">Score</td><td style="padding:20px;">'+score.toString()+'</tr><tr><td>Time</td><td style="padding:20px;">'+gameTime.toString()+"</td></tr></table>",html:!0,customClass:"swal-score",imageUrl:"images/gameover.png"}),bestScore>0&&(document.getElementById("score_button").innerHTML="SCORE("+bestScore.toString()+")",document.getElementById("score_button").style.display="inline"),localSave(bestScore,gameCounter,bestGameTime),restartGame()}function startButtonUpdate(e){var t;t=document.getElementById("start"),null!=e?t.innerHTML="Level "+e.toString():t.innerHTML="Start"}function nextLevel(){clear(),playerFlag=!1,currentMove=0,level+=1,selectCounter+=1,speed>550&&(speed-=speedStep),mutationCheck(),score+=1,scoreUpdate(),startButtonUpdate(level),startGame()}function replyClick(e){!1==simFlag&&!0==playerFlag&&(clear(),clearTimeouts(),set(e,2,currentMove+1),selectedItem[currentMove]==parseInt(e)?(currentMove+=1)==selectCounter?(playerFlag=!1,clearTimeouts(),trophy(),timeouts.push(window.setTimeout(function(){nextLevel()},nextLevelDelay))):timeouts.push(window.setTimeout(function(){reset(e)},resetDelay)):(set(e,3),playerFlag=!1,timeouts.push(window.setTimeout(function(){reset(e),gameOver()},gameOverDelay))))}function scoreTable(){gameCounter>0&&swal({title:"Score!",text:'<table align="center" style="font-size:26px;"><tr><td style="padding:20px;">Best Score</td><td style="padding:20px;">'+bestScore.toString()+'</td></tr><tr><td>Time</td><td style="padding:20px;">'+bestGameTime.toString()+'</td></tr><tr><td>Game</td><td style="padding:20px;">'+gameCounter.toString()+"</td></tr></table>",html:!0,customClass:"swal-score"})}function clear(){var e;for(e=1;e<blockNumber+1;e++)document.getElementById(e.toString()).innerHTML=""}function trophy(){var e;for(e=1;e<blockNumber+1;e++)document.getElementById(e.toString()).innerHTML=trophyAwsome}function tableStyle(e=!0){var t,o,i;for(i="player-turn",!1==e&&(i="not-allowed"),t=1;t<blockNumber+1;t++)(o=document.getElementById(t.toString())).className=i}function levelShow(){var e,t="Level "+level.toString();for(1==level&&(startTime=new Date,t="Start"),e=1;e<blockNumber+1;e++)document.getElementById(e.toString()).innerHTML=t,document.getElementById(e.toString()).style.color=textColor,document.getElementById(e.toString()).style.fontWeight="bold"}function playerGo(){var e;for(e=1;e<blockNumber+1;e++)document.getElementById(e.toString()).innerHTML="GO",document.getElementById(e.toString()).style.color=textColor,document.getElementById(e.toString()).style.fontWeight="bold";timeouts.push(window.setTimeout(function(){clear(),playerFlag=!0},goDelay))}function startGame(){!1==simFlag&&!1==playerFlag&&(tableStyle(mode=!1),simFlag=!0,levelShow(),timeouts.push(window.setTimeout(function(){clear()},levelShowDelay)),timeouts.push(window.setTimeout(function(){simulation()},levelShowDelay+offset))),!0==playerFlag&&playerGo()}function clearTimeouts(){var e;for(e=0;e<timeouts.length;e++)window.clearTimeout(timeouts[e]);timeouts=[]}function restartGame(){tableStyle(mode=!1),selectedItem=[],startTime=null,endTime=null,clearTimeouts(),clear(),simFlag=!1,playerFlag=!1,score=0,currentMove=0,speed=speedDefault,level=1,selectCounter=1,startButtonUpdate(null),scoreUpdate(),(!0==mutationFlag1||!0==mutationFlag2)&&(mutationFlag1=!1,mutationFlag2=!1,mutation(!1)),init()}audio.onended=function(){musicTemp.push(musicList.splice(musicRandom,1)),musicRandom=Math.floor(Math.random()*musicList.length),audio.src=musicList[musicRandom],audio.load(),1==musicList.length&&(musicList.push.apply(musicList,musicTemp),musicTemp=[]),audio.play()},(hr>=19||hr<6)&&(tickAwsome='<i class="fa fa-check fa-3x" aria-hidden="true" style="color:black"></i>',timesAwsome='<i class="fa fa-times fa-3x" aria-hidden="true" style="color:black"></i>',starAwsome='<i class="fa fa-star fa-3x" aria-hidden="true" style="color:black"></i>',trophyAwsome='<i class="fa fa-trophy fa-3x" aria-hidden="true" style="color:black"></i>',colorList=lightColors,textColor="black"),shortcut.add("q",function(){swalHelp()}),shortcut.add("r",function(){restartGame()});